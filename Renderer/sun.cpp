#include "stdafx.h"
#include "sun.h"
#include "general math.h"	// for lerp

using namespace std;
using namespace Renderer;
using namespace Math;
using namespace Sun::HLSL;

/*
	from ftp://ftp.ngdc.noaa.gov/STP/SOLAR_DATA/SOLAR_IRRADIANCE/ARVESEN.DAT
	[380-780] nm range, variable step
	
	In the source it is noted that data published in 1969, in https://www.ngdc.noaa.gov/stp/solar/solarirrad.html it is placed in "Older, archival databases" section.
	Maybe it is worh to use more fresh data?
*/
constexpr double spectralIrradianceTable[][2] =
{
	380.0, 1.108,
	380.1, 1.164,
	380.2, 1.216,
	380.3, 1.260,
	380.4, 1.304,
	380.5, 1.348,
	380.6, 1.387,
	380.7, 1.406,
	380.8, 1.426,
	380.9, 1.446,
	381.0, 1.446,
	381.1, 1.341,
	381.2, 1.237,
	381.3, 1.132,
	381.4, 1.043,
	381.5, 1.057,
	381.6, 1.071,
	381.7, 1.085,
	381.8, 1.092,
	381.9, 1.017,
	382.0, 0.942,
	382.1, 0.867,
	382.2, 0.794,
	382.3, 0.744,
	382.4, 0.695,
	382.5, 0.645,
	382.6, 0.596,
	382.7, 0.640,
	382.8, 0.684,
	382.9, 0.728,
	383.0, 0.738,
	383.1, 0.747,
	383.2, 0.757,
	383.3, 0.724,
	383.4, 0.689,
	383.5, 0.654,
	383.6, 0.689,
	383.7, 0.731,
	383.8, 0.793,
	383.9, 0.725,
	384.0, 0.657,
	384.1, 0.803,
	384.2, 0.978,
	384.3, 1.153,
	384.4, 1.186,
	384.5, 1.192,
	384.6, 1.199,
	384.7, 1.211,
	384.8, 1.224,
	384.9, 1.237,
	385.0, 1.251,
	385.1, 1.265,
	385.2, 1.279,
	385.3, 1.241,
	385.4, 1.187,
	385.5, 1.133,
	385.6, 1.103,
	385.7, 1.081,
	385.8, 1.059,
	385.9, 0.993,
	386.0, 0.908,
	386.1, 0.824,
	386.2, 0.845,
	386.3, 0.917,
	386.4, 0.989,
	386.5, 1.061,
	386.6, 1.133,
	386.7, 1.125,
	386.8, 1.070,
	386.9, 1.016,
	387.0, 0.962,
	387.1, 0.929,
	387.2, 0.911,
	387.3, 0.893,
	387.4, 0.969,
	387.5, 1.117,
	387.6, 1.265,
	387.7, 1.300,
	387.8, 1.239,
	387.9, 1.177,
	388.0, 1.116,
	388.1, 1.058,
	388.2, 1.004,
	388.3, 0.950,
	388.4, 0.928,
	388.5, 0.941,
	388.6, 0.954,
	388.7, 0.986,
	388.8, 0.979,
	388.9, 1.022,
	389.0, 1.106,
	389.1, 1.189,
	389.2, 1.256,
	389.3, 1.298,
	389.4, 1.340,
	389.5, 1.379,
	389.6, 1.414,
	389.7, 1.448,
	389.8, 1.452,
	389.9, 1.396,
	390.0, 1.341,
	390.1, 1.293,
	390.2, 1.263,
	390.3, 1.233,
	390.4, 1.189,
	390.5, 1.110,
	390.6, 1.031,
	390.7, 1.009,
	390.8, 1.157,
	390.9, 1.304,
	391.0, 1.429,
	391.1, 1.476,
	391.2, 1.523,
	391.3, 1.551,
	391.4, 1.503,
	391.5, 1.454,
	391.6, 1.410,
	391.7, 1.391,
	391.8, 1.373,
	391.9, 1.347,
	392.0, 1.283,
	392.1, 1.218,
	392.2, 1.153,
	392.3, 1.099,
	392.4, 1.138,
	392.5, 1.177,
	392.6, 1.208,
	392.7, 1.137,
	392.8, 1.067,
	392.9, 0.850,
	393.0, 0.734,
	393.1, 0.618,
	393.2, 0.503,
	393.3, 0.438,
	393.4, 0.372,
	393.5, 0.312,
	393.6, 0.425,
	393.7, 0.538,
	393.8, 0.654,
	393.9, 0.794,
	394.0, 0.934,
	394.1, 1.050,
	394.2, 1.076,
	394.3, 1.102,
	394.4, 1.151,
	394.5, 1.251,
	394.6, 1.351,
	394.7, 1.400,
	394.8, 1.374,
	394.9, 1.348,
	395.0, 1.353,
	395.1, 1.390,
	395.2, 1.427,
	395.3, 1.453,
	395.4, 1.473,
	395.5, 1.493,
	395.6, 1.453,
	395.7, 1.385,
	395.8, 1.318,
	395.9, 1.224,
	396.0, 1.122,
	396.1, 1.021,
	396.2, 0.966,
	396.3, 0.917,
	396.4, 0.869,
	396.5, 0.820,
	396.6, 0.670,
	396.7, 0.520,
	396.8, 0.370,
	396.9, 0.426,
	397.0, 0.484,
	397.1, 0.541,
	397.2, 0.704,
	397.3, 0.867,
	397.4, 1.031,
	397.5, 1.116,
	397.6, 1.199,
	397.7, 1.282,
	397.8, 1.436,
	397.9, 1.592,
	398.0, 1.748,
	398.1, 1.695,
	398.2, 1.635,
	398.3, 1.574,
	398.4, 1.613,
	398.5, 1.656,
	398.6, 1.699,
	398.7, 1.762,
	398.8, 1.826,
	398.9, 1.890,
	399.0, 1.872,
	399.1, 1.849,
	399.2, 1.826,
	399.3, 1.801,
	399.4, 1.776,
	399.5, 1.750,
	399.6, 1.670,
	399.7, 1.587,
	399.8, 1.503,
	399.9, 1.590,
	400.0, 1.692,
	400.1, 1.793,
	400.2, 1.844,
	400.3, 1.892,
	400.4, 1.939,
	400.5, 1.781,
	400.6, 1.604,
	400.7, 1.426,
	400.8, 1.508,
	400.9, 1.617,
	401.0, 1.726,
	401.1, 1.796,
	401.2, 1.863,
	401.3, 1.929,
	401.4, 1.950,
	401.5, 1.966,
	401.6, 1.982,
	401.7, 1.978,
	401.8, 1.920,
	401.9, 1.862,
	402.0, 1.833,
	402.1, 1.808,
	402.2, 1.782,
	402.3, 1.779,
	402.4, 1.779,
	402.5, 1.779,
	402.6, 1.831,
	402.7, 1.892,
	402.8, 1.952,
	402.9, 1.802,
	403.0, 1.617,
	403.1, 1.433,
	403.2, 1.459,
	403.3, 1.522,
	403.4, 1.585,
	403.5, 1.733,
	403.6, 1.897,
	403.7, 2.060,
	403.8, 2.010,
	403.9, 1.920,
	404.0, 1.829,
	404.1, 1.889,
	404.2, 1.980,
	404.3, 2.072,
	404.4, 1.769,
	404.5, 1.384,
	404.6, 0.998,
	404.7, 1.176,
	404.8, 1.478,
	404.9, 1.780,
	405.0, 1.822,
	405.1, 1.805,
	405.2, 1.787,
	405.3, 1.736,
	405.4, 1.676,
	405.5, 1.617,
	405.6, 1.573,
	405.7, 1.533,
	405.8, 1.494,
	405.9, 1.602,
	406.0, 1.749,
	406.1, 1.897,
	406.2, 1.792,
	406.3, 1.619,
	406.4, 1.446,
	406.5, 1.433,
	406.6, 1.467,
	406.7, 1.501,
	406.8, 1.643,
	406.9, 1.818,
	407.0, 1.992,
	407.1, 2.007,
	407.2, 1.973,
	407.3, 1.939,
	407.4, 1.859,
	407.5, 1.765,
	407.6, 1.671,
	407.7, 1.703,
	407.8, 1.777,
	407.9, 1.851,
	408.0, 1.876,
	408.1, 1.885,
	408.2, 1.893,
	408.3, 1.874,
	408.4, 1.845,
	408.5, 1.817,
	408.6, 1.881,
	408.7, 1.980,
	408.8, 2.078,
	408.9, 2.080,
	409.0, 2.045,
	409.1, 2.010,
	409.2, 1.995,
	409.3, 1.989,
	409.4, 1.983,
	409.5, 1.918,
	409.6, 1.829,
	409.7, 1.740,
	409.8, 1.655,
	409.9, 1.573,
	410.0, 1.490,
	410.1, 1.471,
	410.2, 1.478,
	410.3, 1.486,
	410.4, 1.540,
	410.5, 1.613,
	410.6, 1.687,
	410.7, 1.900,
	410.8, 1.890,
	410.9, 1.879,
	411.0, 1.893,
	411.1, 1.919,
	411.2, 1.945,
	411.3, 1.984,
	411.4, 2.029,
	411.5, 2.075,
	411.6, 1.979,
	411.7, 1.812,
	411.8, 1.645,
	411.9, 1.667,
	412.0, 1.787,
	412.1, 1.907,
	412.2, 1.951,
	412.3, 1.953,
	412.4, 1.956,
	412.5, 1.944,
	412.6, 1.924,
	412.7, 1.904,
	412.8, 1.900,
	412.9, 1.904,
	413.0, 1.909,
	413.1, 1.862,
	413.2, 1.784,
	413.3, 1.706,
	413.4, 1.748,
	413.5, 1.863,
	413.6, 1.977,
	413.7, 2.050,
	413.8, 2.098,
	413.9, 2.146,
	414.0, 2.094,
	414.1, 1.978,
	414.2, 1.862,
	414.3, 1.835,
	414.4, 1.868,
	414.5, 1.901,
	414.6, 1.963,
	414.7, 2.046,
	414.8, 2.128,
	414.9, 2.112,
	415.0, 2.028,
	415.1, 1.944,
	415.2, 1.852,
	415.3, 1.754,
	415.4, 1.655,
	415.5, 1.652,
	415.6, 1.719,
	415.7, 1.785,
	415.8, 1.864,
	415.9, 1.953,
	416.0, 2.043,
	416.1, 2.116,
	416.2, 2.177,
	416.3, 2.238,
	416.4, 2.228,
	416.5, 2.162,
	416.6, 2.097,
	416.7, 2.067,
	416.8, 2.067,
	416.9, 2.068,
	417.0, 1.976,
	417.1, 1.809,
	417.2, 1.641,
	417.3, 1.601,
	417.4, 1.670,
	417.5, 1.739,
	417.6, 1.761,
	417.7, 1.742,
	417.8, 1.722,
	417.9, 1.722,
	418.0, 1.739,
	418.1, 1.755,
	418.2, 1.791,
	418.3, 1.845,
	418.4, 1.898,
	418.5, 1.858,
	418.6, 1.728,
	418.7, 1.597,
	418.8, 1.647,
	418.9, 1.875,
	419.0, 2.103,
	419.1, 2.223,
	419.2, 2.233,
	419.3, 2.243,
	419.4, 2.202,
	419.5, 2.108,
	419.6, 2.013,
	419.7, 1.732,
	419.8, 1.736,
	419.9, 1.740,
	420.0, 1.725,
	420.1, 1.690,
	420.2, 1.656,
	420.3, 1.687,
	420.4, 1.793,
	420.5, 1.899,
	420.6, 1.969,
	420.7, 1.998,
	420.8, 2.027,
	420.9, 2.039,
	421.0, 2.030,
	421.1, 2.020,
	421.2, 2.017,
	421.3, 2.022,
	421.4, 2.027,
	421.5, 2.005,
	421.6, 1.951,
	421.7, 1.897,
	421.8, 1.899,
	421.9, 1.975,
	422.0, 2.051,
	422.1, 2.050,
	422.2, 1.946,
	422.3, 1.842,
	422.4, 1.670,
	422.5, 1.405,
	422.6, 1.141,
	422.7, 1.117,
	422.8, 1.430,
	422.9, 1.743,
	423.0, 1.911,
	423.1, 1.869,
	423.2, 1.827,
	423.3, 1.758,
	423.4, 1.652,
	423.5, 1.545,
	423.6, 1.525,
	423.7, 1.639,
	423.8, 1.752,
	423.9, 1.834,
	424.0, 1.866,
	424.1, 1.898,
	424.2, 1.949,
	424.3, 2.032,
	424.4, 2.114,
	424.5, 2.107,
	424.6, 1.951,
	424.7, 1.796,
	424.8, 1.686,
	424.9, 1.655,
	425.0, 1.624,
	425.1, 1.610,
	425.2, 1.628,
	425.3, 1.645,
	425.4, 1.718,
	425.5, 1.892,
	425.6, 2.066,
	425.7, 2.079,
	425.8, 1.793,
	425.9, 1.506,
	426.0, 1.402,
	426.1, 1.650,
	426.2, 1.897,
	426.3, 2.055,
	426.4, 2.035,
	426.5, 2.014,
	426.6, 1.974,
	426.7, 1.893,
	426.8, 1.812,
	426.9, 1.718,
	427.0, 1.597,
	427.1, 1.475,
	427.2, 1.419,
	427.3, 1.507,
	427.4, 1.595,
	427.5, 1.695,
	427.6, 1.823,
	427.7, 1.951,
	427.8, 2.015,
	427.9, 1.931,
	428.0, 1.847,
	428.1, 1.794,
	428.2, 1.818,
	428.3, 1.841,
	428.4, 1.854,
	428.5, 1.841,
	428.6, 1.828,
	428.7, 1.761,
	428.8, 1.665,
	428.9, 1.568,
	429.0, 1.520,
	429.1, 1.602,
	429.2, 1.683,
	429.3, 1.729,
	429.4, 1.676,
	429.5, 1.624,
	429.6, 1.536,
	429.7, 1.348,
	429.8, 1.160,
	429.9, 1.032,
	430.0, 1.080,
	430.1, 1.127,
	430.2, 1.173,
	430.3, 1.215,
	430.4, 1.256,
	430.5, 1.262,
	430.6, 1.156,
	430.7, 1.049,
	430.8, 0.989,
	430.9, 1.079,
	431.0, 1.169,
	431.1, 1.273,
	431.2, 1.424,
	431.3, 1.574,
	431.4, 1.732,
	431.5, 1.919,
	431.6, 2.106,
	431.7, 2.234,
	431.8, 2.143,
	431.9, 2.052,
	432.0, 1.938,
	432.1, 1.735,
	432.2, 1.533,
	432.3, 1.384,
	432.4, 1.445,
	432.5, 1.506,
	432.6, 1.584,
	432.7, 1.737,
	432.8, 1.889,
	432.9, 2.015,
	433.0, 2.025,
	433.1, 2.036,
	433.2, 2.044,
	433.3, 2.043,
	433.4, 2.043,
	433.5, 2.007,
	433.6, 1.805,
	433.7, 1.603,
	433.8, 1.438,
	433.9, 1.458,
	434.0, 1.477,
	434.1, 1.511,
	434.2, 1.621,
	434.3, 1.730,
	434.4, 1.829,
	434.5, 1.876,
	434.6, 1.922,
	434.7, 1.948,
	434.8, 1.856,
	434.9, 1.764,
	435.0, 1.694,
	435.1, 1.759,
	435.2, 1.825,
	435.3, 1.887,
	435.4, 1.929,
	435.5, 1.970,
	435.6, 1.998,
	435.7, 1.929,
	435.8, 1.861,
	435.9, 1.810,
	436.0, 1.884,
	436.1, 1.959,
	436.2, 2.030,
	436.3, 2.067,
	436.4, 2.105,
	436.5, 2.135,
	436.6, 2.100,
	436.7, 2.065,
	436.8, 2.029,
	436.9, 1.988,
	437.0, 1.947,
	437.1, 1.901,
	437.2, 1.806,
	437.3, 1.711,
	437.4, 1.631,
	437.5, 1.705,
	437.6, 1.926,
	437.7, 1.922,
	437.8, 1.919,
	437.9, 1.898,
	438.0, 1.679,
	438.1, 1.459,
	438.2, 1.268,
	438.3, 1.460,
	438.4, 1.653,
	438.5, 1.832,
	438.6, 1.804,
	438.7, 1.777,
	438.8, 1.752,
	438.9, 1.778,
	439.0, 1.805,
	439.1, 1.830,
	439.2, 1.814,
	439.3, 1.798,
	439.4, 1.788,
	439.5, 1.907,
	439.6, 2.026,
	439.7, 2.136,
	439.8, 2.001,
	439.9, 1.866,
	440.0, 1.735,
	440.1, 1.714,
	440.2, 1.693,
	440.3, 1.675,
	440.4, 1.770,
	440.5, 1.865,
	440.6, 1.958,
	440.7, 1.982,
	440.8, 2.005,
	440.9, 2.029,
	441.0, 2.099,
	441.1, 2.168,
	441.2, 2.237,
	441.3, 1.969,
	441.4, 1.701,
	441.5, 1.840,
	441.6, 1.981,
	441.7, 2.078,
	441.8, 2.176,
	441.9, 2.138,
	442.0, 2.099,
	442.1, 1.979,
	442.2, 1.858,
	442.3, 1.994,
	442.4, 2.135,
	442.5, 2.102,
	442.6, 2.064,
	442.7, 2.066,
	442.8, 2.068,
	442.9, 1.987,
	443.0, 1.902,
	443.1, 1.960,
	443.2, 2.023,
	443.3, 1.874,
	443.4, 1.715,
	443.5, 1.859,
	443.6, 2.018,
	443.7, 2.057,
	443.8, 2.090,
	443.9, 2.073,
	444.0, 2.054,
	444.1, 1.937,
	444.2, 1.815,
	444.3, 1.977,
	444.4, 2.159,
	444.5, 2.111,
	444.6, 2.047,
	444.7, 2.068,
	444.8, 2.096,
	444.9, 2.124,
	445.0, 2.159,
	445.1, 2.196,
	445.2, 1.988,
	445.3, 1.758,
	445.4, 1.765,
	445.5, 1.796,
	445.6, 1.816,
	445.7, 1.835,
	445.8, 1.866,
	445.9, 1.898,
	446.0, 1.981,
	446.1, 2.068,
	446.2, 2.156,
	446.3, 2.105,
	446.4, 2.036,
	446.5, 2.019,
	446.6, 2.009,
	446.7, 1.957,
	446.8, 1.921,
	446.9, 1.957,
	447.0, 2.003,
	447.1, 2.036,
	447.2, 2.067,
	447.3, 2.125,
	447.4, 2.187,
	447.5, 2.208,
	447.6, 2.222,
	447.7, 2.205,
	447.8, 2.183,
	447.9, 2.034,
	448.0, 1.863,
	448.1, 1.913,
	448.2, 2.001,
	448.3, 2.092,
	448.4, 2.184,
	448.5, 2.238,
	448.6, 2.285,
	448.7, 2.142,
	448.8, 1.962,
	448.9, 2.016,
	449.0, 2.115,
	449.1, 2.139,
	449.2, 2.147,
	449.3, 2.069,
	449.4, 1.974,
	449.5, 1.991,
	449.6, 2.032,
	449.7, 2.068,
	449.8, 2.103,
	449.9, 2.071,
	450.0, 2.023,
	450.1, 2.074,
	450.2, 2.149,
	450.3, 2.244,
	450.4, 2.345,
	450.5, 2.330,
	450.6, 2.286,
	450.7, 2.251,
	450.8, 2.219,
	450.9, 2.253,
	451.0, 2.305,
	451.1, 2.254,
	451.2, 2.174,
	451.3, 2.132,
	451.4, 2.102,
	451.5, 2.124,
	451.6, 2.163,
	451.7, 2.169,
	451.8, 2.165,
	451.9, 2.195,
	452.0, 2.237,
	452.1, 2.159,
	452.2, 2.044,
	452.3, 2.036,
	452.4, 2.064,
	452.5, 1.974,
	452.6, 1.845,
	452.7, 1.812,
	452.8, 1.811,
	452.9, 1.821,
	453.0, 1.835,
	453.1, 1.936,
	453.2, 2.068,
	453.3, 2.002,
	453.4, 1.863,
	453.5, 1.966,
	453.6, 2.158,
	453.7, 2.177,
	453.8, 2.130,
	453.9, 2.085,
	454.0, 2.042,
	454.1, 2.094,
	454.2, 2.185,
	454.3, 2.176,
	454.4, 2.127,
	454.5, 2.100,
	454.6, 2.081,
	454.7, 2.024,
	454.8, 1.951,
	454.9, 1.988,
	455.0, 2.075,
	455.1, 2.099,
	455.2, 2.095,
	455.3, 2.040,
	455.4, 1.961,
	455.5, 1.985,
	455.6, 2.056,
	455.7, 2.183,
	455.8, 2.161,
	455.9, 2.141,
	456.0, 2.121,
	456.1, 2.149,
	456.2, 2.200,
	456.3, 2.155,
	456.4, 2.061,
	456.5, 2.069,
	456.6, 2.128,
	456.7, 2.169,
	456.8, 2.201,
	456.9, 2.169,
	457.0, 2.103,
	457.1, 2.112,
	457.2, 2.163,
	457.3, 2.196,
	457.4, 2.220,
	457.5, 2.232,
	457.6, 2.238,
	457.7, 2.200,
	457.8, 2.137,
	457.9, 2.072,
	458.0, 2.005,
	458.1, 2.045,
	458.2, 2.149,
	458.3, 2.139,
	458.4, 2.059,
	458.5, 2.057,
	458.6, 2.105,
	458.7, 2.162,
	458.8, 2.224,
	458.9, 2.223,
	459.0, 2.182,
	459.1, 2.138,
	459.2, 2.091,
	459.3, 2.083,
	459.4, 2.099,
	459.5, 2.074,
	459.6, 2.019,
	459.7, 2.038,
	459.8, 2.109,
	459.9, 2.067,
	460.0, 1.946,
	460.1, 1.936,
	460.2, 2.008,
	460.3, 2.079,
	460.4, 2.086,
	460.5, 2.046,
	460.6, 2.084,
	460.7, 2.182,
	460.8, 2.280,
	460.9, 2.248,
	461.0, 2.114,
	461.1, 2.077,
	461.2, 2.117,
	461.3, 2.157,
	461.4, 2.197,
	461.5, 2.175,
	461.6, 2.101,
	461.7, 2.056,
	461.8, 2.034,
	461.9, 2.078,
	462.0, 2.179,
	462.1, 2.189,
	462.2, 2.122,
	462.3, 2.120,
	462.4, 2.175,
	462.5, 2.200,
	462.6, 2.200,
	462.7, 2.169,
	462.8, 2.110,
	462.9, 2.127,
	463.0, 2.214,
	463.1, 2.192,
	463.2, 2.069,
	463.3, 2.048,
	463.4, 2.124,
	463.5, 2.151,
	463.6, 2.131,
	463.7, 2.120,
	463.8, 2.117,
	463.9, 2.133,
	464.0, 2.169,
	464.1, 2.157,
	464.2, 2.094,
	464.3, 2.079,
	464.4, 2.115,
	464.5, 2.086,
	464.6, 1.895,
	464.7, 1.911,
	464.8, 1.954,
	464.9, 2.027,
	465.0, 2.070,
	465.1, 2.080,
	465.2, 2.062,
	465.3, 2.013,
	465.4, 1.999,
	465.5, 2.026,
	465.6, 2.086,
	465.7, 2.185,
	465.8, 2.231,
	465.9, 2.214,
	466.0, 2.170,
	466.1, 2.092,
	466.2, 2.072,
	466.3, 2.121,
	466.4, 2.094,
	466.5, 1.970,
	466.6, 1.867,
	466.7, 1.789,
	466.8, 1.829,
	466.9, 2.021,
	467.0, 2.120,
	467.1, 2.092,
	467.2, 2.084,
	467.3, 2.105,
	467.4, 2.126,
	467.5, 2.149,
	467.6, 2.131,
	467.7, 2.053,
	467.8, 1.987,
	467.9, 1.936,
	468.0, 1.912,
	468.1, 1.929,
	468.2, 1.976,
	468.3, 2.070,
	468.4, 2.124,
	468.5, 2.116,
	468.6, 2.116,
	468.7, 2.128,
	468.8, 2.125,
	468.9, 2.097,
	469.0, 2.086,
	469.1, 2.102,
	469.2, 2.091,
	469.3, 2.033,
	469.4, 2.050,
	469.5, 2.189,
	469.6, 2.219,
	469.7, 2.061,
	469.8, 1.971,
	469.9, 1.999,
	470.0, 2.002,
	470.1, 1.959,
	470.2, 1.939,
	470.3, 1.962,
	470.4, 1.992,
	470.5, 2.038,
	470.6, 2.041,
	470.7, 1.964,
	470.8, 1.937,
	470.9, 2.005,
	471.0, 2.063,
	471.1, 2.100,
	471.2, 2.098,
	471.3, 2.018,
	471.4, 1.988,
	471.5, 2.061,
	471.6, 2.131,
	471.7, 2.194,
	471.8, 2.233,
	471.9, 2.220,
	472.0, 2.207,
	472.1, 2.189,
	472.2, 2.172,
	472.3, 2.176,
	472.4, 2.225,
	472.5, 2.224,
	472.6, 2.107,
	472.7, 2.027,
	472.8, 2.032,
	472.9, 2.012,
	473.0, 1.933,
	473.1, 1.913,
	473.2, 2.037,
	473.3, 2.132,
	473.4, 2.151,
	473.5, 2.147,
	473.6, 2.032,
	473.7, 2.103,
	473.8, 2.146,
	473.9, 2.116,
	474.0, 2.088,
	474.1, 2.064,
	474.2, 2.059,
	474.3, 2.105,
	474.4, 2.126,
	474.5, 2.074,
	474.6, 2.058,
	474.7, 2.147,
	474.8, 2.206,
	474.9, 2.175,
	475.0, 2.149,
	475.1, 2.140,
	475.2, 2.124,
	475.3, 2.089,
	475.4, 2.057,
	475.5, 2.036,
	475.6, 2.029,
	475.7, 2.069,
	475.8, 2.121,
	475.9, 2.213,
	476.0, 2.268,
	476.1, 2.199,
	476.2, 2.131,
	476.3, 2.077,
	476.4, 2.075,
	476.5, 2.063,
	476.6, 2.008,
	476.7, 1.982,
	476.8, 2.066,
	476.9, 2.128,
	477.0, 2.108,
	477.1, 2.086,
	477.2, 2.058,
	477.3, 2.062,
	477.4, 2.195,
	477.5, 2.293,
	477.6, 2.242,
	477.7, 2.197,
	477.8, 2.175,
	477.9, 2.164,
	478.0, 2.198,
	478.1, 2.208,
	478.2, 2.102,
	478.3, 2.029,
	478.4, 2.109,
	478.5, 2.164,
	478.6, 2.099,
	478.7, 2.045,
	478.8, 2.047,
	478.9, 2.057,
	479.0, 2.108,
	479.1, 2.153,
	479.2, 2.169,
	479.3, 2.189,
	479.4, 2.232,
	479.5, 2.265,
	479.6, 2.233,
	479.7, 2.200,
	479.8, 2.164,
	479.9, 2.131,
	480.0, 2.115,
	480.1, 2.106,
	480.2, 2.147,
	480.3, 2.173,
	480.4, 2.101,
	480.5, 2.040,
	480.6, 2.061,
	480.7, 2.079,
	480.8, 2.077,
	480.9, 2.073,
	481.0, 2.052,
	481.1, 2.033,
	481.2, 2.036,
	481.3, 2.047,
	481.4, 2.113,
	481.5, 2.176,
	481.6, 2.220,
	481.7, 2.256,
	481.8, 2.225,
	481.9, 2.193,
	482.0, 2.160,
	482.1, 2.119,
	482.2, 2.005,
	482.3, 1.912,
	482.4, 2.045,
	482.5, 2.167,
	482.6, 2.162,
	482.7, 2.146,
	482.8, 2.082,
	482.9, 2.024,
	483.0, 2.035,
	483.1, 2.044,
	483.2, 2.024,
	483.3, 2.011,
	483.4, 2.106,
	483.5, 2.195,
	483.6, 2.199,
	483.7, 2.197,
	483.8, 2.093,
	483.9, 1.995,
	484.0, 1.992,
	484.1, 1.991,
	484.2, 2.030,
	484.3, 2.068,
	484.4, 2.083,
	484.5, 2.098,
	484.6, 2.087,
	484.7, 2.076,
	484.8, 2.058,
	484.9, 2.042,
	485.0, 2.076,
	485.1, 2.109,
	485.2, 2.086,
	485.3, 2.060,
	485.4, 1.914,
	485.5, 1.770,
	485.6, 1.802,
	485.7, 1.832,
	485.8, 1.685,
	485.9, 1.537,
	486.0, 1.282,
	486.1, 1.028,
	486.2, 1.353,
	486.3, 1.679,
	486.4, 1.728,
	486.5, 1.777,
	486.6, 1.821,
	486.7, 1.865,
	486.8, 1.965,
	486.9, 2.066,
	487.0, 1.825,
	487.1, 1.585,
	487.2, 1.768,
	487.3, 1.950,
	487.4, 1.929,
	487.5, 1.908,
	487.6, 1.955,
	487.7, 2.002,
	487.8, 2.068,
	487.9, 2.134,
	488.0, 2.053,
	488.1, 1.971,
	488.2, 2.022,
	488.3, 2.074,
	488.4, 1.941,
	488.5, 1.807,
	488.6, 1.879,
	488.7, 1.951,
	488.8, 1.932,
	488.9, 1.914,
	489.0, 1.719,
	489.1, 1.525,
	489.2, 1.831,
	489.3, 2.138,
	489.4, 2.150,
	489.5, 2.162,
	489.6, 2.167,
	489.7, 2.173,
	489.8, 2.151,
	489.9, 2.128,
	490.0, 2.155,
	490.1, 2.182,
	490.2, 2.090,
	490.3, 1.998,
	490.4, 2.051,
	490.5, 2.105,
	490.6, 2.150,
	490.7, 2.194,
	490.8, 2.108,
	490.9, 2.023,
	491.0, 1.931,
	491.1, 1.840,
	491.2, 1.983,
	491.3, 2.126,
	491.4, 2.127,
	491.5, 2.127,
	491.6, 2.128,
	491.7, 1.955,
	491.8, 1.782,
	491.9, 1.675,
	492.0, 1.567,
	492.1, 1.747,
	492.2, 1.926,
	492.3, 1.931,
	492.4, 1.935,
	492.5, 2.023,
	492.6, 2.110,
	492.7, 2.064,
	492.8, 2.018,
	492.9, 2.035,
	493.0, 2.051,
	493.1, 2.112,
	493.2, 2.173,
	493.3, 2.077,
	493.4, 1.981,
	493.5, 2.036,
	493.6, 2.090,
	493.7, 1.946,
	493.8, 1.801,
	493.9, 1.917,
	494.0, 2.033,
	494.1, 2.098,
	494.2, 2.164,
	494.3, 2.161,
	494.4, 2.159,
	494.5, 2.085,
	494.6, 2.010,
	494.7, 2.118,
	494.8, 2.227,
	494.9, 2.144,
	495.0, 2.061,
	495.1, 2.037,
	495.2, 2.013,
	495.3, 2.002,
	495.4, 1.990,
	495.5, 1.895,
	495.6, 1.800,
	495.7, 1.837,
	495.8, 1.874,
	495.9, 1.934,
	496.0, 1.994,
	496.1, 2.054,
	496.2, 2.114,
	496.3, 2.085,
	496.4, 2.056,
	496.5, 2.055,
	496.6, 2.054,
	496.7, 2.053,
	496.8, 2.052,
	496.9, 2.039,
	497.0, 2.027,
	497.1, 2.064,
	497.2, 2.102,
	497.3, 2.141,
	497.4, 2.180,
	497.5, 2.139,
	497.6, 2.098,
	497.7, 2.084,
	497.8, 2.070,
	497.9, 2.002,
	498.0, 1.935,
	498.1, 1.801,
	498.2, 1.668,
	498.3, 1.755,
	498.4, 1.843,
	498.5, 1.931,
	498.6, 1.996,
	498.7, 2.061,
	498.8, 2.041,
	498.9, 2.024,
	499.0, 2.006,
	499.1, 2.014,
	499.2, 2.023,
	499.3, 2.032,
	499.4, 2.030,
	499.5, 2.028,
	499.6, 2.027,
	499.7, 1.999,
	499.8, 1.972,
	499.9, 1.945,
	500.0, 1.927,
	500.1, 1.910,
	500.2, 1.893,
	500.3, 1.893,
	500.4, 1.894,
	500.5, 1.895,
	500.6, 1.895,
	500.7, 1.896,
	500.8, 1.992,
	500.9, 2.088,
	501.0, 2.037,
	501.1, 1.985,
	501.2, 1.933,
	501.3, 1.882,
	501.4, 1.830,
	501.5, 1.857,
	501.6, 1.885,
	501.7, 1.894,
	501.8, 1.904,
	501.9, 1.913,
	502.0, 1.922,
	502.1, 1.931,
	502.2, 1.940,
	502.3, 1.979,
	502.4, 2.018,
	502.5, 1.967,
	502.6, 1.916,
	502.7, 1.955,
	502.8, 1.995,
	502.9, 2.012,
	503.0, 2.030,
	503.1, 2.048,
	503.2, 2.075,
	503.3, 2.103,
	503.4, 1.983,
	503.5, 1.864,
	503.6, 1.906,
	503.7, 1.948,
	503.8, 1.815,
	503.9, 1.682,
	504.0, 1.668,
	504.1, 1.654,
	504.2, 1.887,
	504.3, 2.119,
	504.4, 2.096,
	504.5, 2.073,
	504.6, 2.050,
	504.7, 2.027,
	504.8, 2.005,
	504.9, 1.982,
	505.0, 1.959,
	505.1, 1.936,
	505.2, 1.975,
	505.3, 2.015,
	505.4, 2.039,
	505.5, 2.063,
	505.6, 2.087,
	505.7, 2.111,
	505.8, 2.141,
	505.9, 2.171,
	506.0, 2.128,
	506.1, 2.086,
	506.2, 2.043,
	506.3, 2.000,
	506.4, 1.936,
	506.5, 1.873,
	506.6, 1.889,
	506.7, 1.906,
	506.8, 1.969,
	506.9, 2.033,
	507.0, 1.980,
	507.1, 1.927,
	507.2, 1.989,
	507.3, 2.051,
	507.4, 2.078,
	507.5, 2.106,
	507.6, 2.021,
	507.7, 1.937,
	507.8, 1.824,
	507.9, 1.712,
	508.0, 1.814,
	508.1, 1.915,
	508.2, 1.867,
	508.3, 1.818,
	508.4, 1.922,
	508.5, 2.026,
	508.6, 2.046,
	508.7, 2.065,
	508.8, 2.059,
	508.9, 2.053,
	509.0, 2.062,
	509.1, 2.072,
	509.2, 2.117,
	509.3, 2.161,
	509.4, 2.103,
	509.5, 2.046,
	509.6, 1.968,
	509.7, 1.891,
	509.8, 1.852,
	509.9, 1.813,
	510.0, 1.927,
	510.1, 2.042,
	510.2, 2.031,
	510.3, 2.021,
	510.4, 2.040,
	510.5, 2.060,
	510.6, 2.012,
	510.7, 1.964,
	510.8, 1.915,
	510.9, 1.867,
	511.0, 1.973,
	511.1, 2.078,
	511.2, 2.069,
	511.3, 2.059,
	511.4, 2.086,
	511.5, 2.112,
	511.6, 2.086,
	511.7, 2.059,
	511.8, 2.033,
	511.9, 2.006,
	512.0, 1.980,
	512.1, 1.954,
	512.2, 1.927,
	512.3, 1.901,
	512.4, 1.874,
	512.5, 1.848,
	512.6, 1.866,
	512.7, 1.883,
	512.8, 1.901,
	512.9, 1.919,
	513.0, 1.953,
	513.1, 1.987,
	513.2, 1.946,
	513.3, 1.905,
	513.4, 1.959,
	513.5, 2.013,
	513.6, 1.953,
	513.7, 1.892,
	513.8, 1.802,
	513.9, 1.773,
	514.0, 1.772,
	514.1, 1.771,
	514.2, 1.836,
	514.3, 1.902,
	514.4, 1.936,
	514.5, 1.971,
	514.6, 1.914,
	514.7, 1.857,
	514.8, 1.891,
	514.9, 1.926,
	515.0, 1.931,
	515.1, 1.936,
	515.2, 1.892,
	515.3, 1.847,
	515.4, 1.878,
	515.5, 1.908,
	515.6, 2.007,
	515.7, 2.107,
	515.8, 2.034,
	515.9, 1.962,
	516.0, 1.961,
	516.1, 1.960,
	516.2, 1.918,
	516.3, 1.876,
	516.4, 1.747,
	516.5, 1.618,
	516.6, 1.475,
	516.7, 1.331,
	516.8, 1.475,
	516.9, 1.638,
	517.0, 1.625,
	517.1, 1.576,
	517.2, 1.526,
	517.3, 1.476,
	517.4, 1.596,
	517.5, 1.833,
	517.6, 1.985,
	517.7, 2.042,
	517.8, 2.059,
	517.9, 2.004,
	518.0, 1.925,
	518.1, 1.767,
	518.2, 1.602,
	518.3, 1.391,
	518.4, 1.180,
	518.5, 1.477,
	518.6, 1.773,
	518.7, 1.866,
	518.8, 1.959,
	518.9, 1.978,
	519.0, 1.997,
	519.1, 1.830,
	519.2, 1.664,
	519.3, 1.727,
	519.4, 1.791,
	519.5, 1.801,
	519.6, 1.810,
	519.7, 1.857,
	519.8, 1.904,
	519.9, 1.949,
	520.0, 1.994,
	520.1, 2.012,
	520.2, 2.030,
	520.3, 1.976,
	520.4, 1.922,
	520.5, 1.848,
	520.6, 1.775,
	520.7, 1.860,
	520.8, 1.946,
	520.9, 1.924,
	521.0, 1.902,
	521.1, 1.978,
	521.2, 2.054,
	521.3, 2.044,
	521.4, 2.021,
	521.5, 1.912,
	521.6, 1.804,
	521.7, 1.812,
	521.8, 1.821,
	521.9, 1.916,
	522.0, 2.011,
	522.1, 1.978,
	522.2, 1.945,
	522.3, 1.962,
	522.4, 1.979,
	522.5, 1.874,
	522.6, 1.769,
	522.7, 1.759,
	522.8, 1.748,
	522.9, 1.856,
	523.0, 1.963,
	523.1, 1.914,
	523.2, 1.865,
	523.3, 1.826,
	523.4, 1.786,
	523.5, 1.815,
	523.6, 1.943,
	523.7, 1.966,
	523.8, 2.088,
	523.9, 2.018,
	524.0, 1.947,
	524.1, 1.943,
	524.2, 1.938,
	524.3, 1.945,
	524.4, 1.952,
	524.5, 2.008,
	524.6, 2.064,
	524.7, 2.002,
	524.8, 1.941,
	524.9, 1.925,
	525.0, 1.910,
	525.1, 1.923,
	525.2, 1.937,
	525.3, 1.947,
	525.4, 1.958,
	525.5, 1.962,
	525.6, 1.966,
	525.7, 2.041,
	525.8, 2.116,
	525.9, 2.055,
	526.0, 1.995,
	526.1, 1.903,
	526.2, 1.812,
	526.3, 1.720,
	526.4, 1.672,
	526.5, 1.629,
	526.6, 1.586,
	526.7, 1.689,
	526.8, 1.792,
	526.9, 1.642,
	527.0, 1.491,
	527.1, 1.701,
	527.2, 1.910,
	527.3, 1.827,
	527.4, 1.827,
	527.5, 1.796,
	527.6, 1.765,
	527.7, 1.895,
	527.8, 2.025,
	527.9, 1.975,
	528.0, 1.925,
	528.1, 1.880,
	528.2, 1.834,
	528.3, 1.828,
	528.4, 1.823,
	528.5, 1.926,
	528.6, 2.029,
	528.7, 2.029,
	528.8, 2.029,
	528.9, 1.998,
	529.0, 1.967,
	529.1, 2.003,
	529.2, 2.039,
	529.3, 1.983,
	529.4, 1.926,
	529.5, 1.938,
	529.6, 1.950,
	529.7, 1.880,
	529.8, 1.811,
	529.9, 1.902,
	530.0, 1.993,
	530.1, 2.013,
	530.2, 2.034,
	530.3, 2.051,
	530.4, 2.068,
	530.5, 2.094,
	530.6, 2.120,
	530.7, 2.097,
	530.8, 2.075,
	530.9, 2.076,
	531.0, 2.076,
	531.1, 2.052,
	531.2, 2.027,
	531.3, 1.993,
	531.4, 1.959,
	531.5, 1.927,
	531.6, 1.896,
	531.7, 1.947,
	531.8, 1.999,
	531.9, 2.020,
	532.0, 2.042,
	532.1, 1.952,
	532.2, 1.863,
	532.3, 1.798,
	532.4, 1.742,
	532.5, 1.754,
	532.6, 1.767,
	532.7, 1.773,
	532.8, 1.779,
	532.9, 1.918,
	533.0, 2.056,
	533.1, 2.034,
	533.2, 2.012,
	533.3, 2.010,
	533.4, 2.008,
	533.5, 1.970,
	533.6, 1.933,
	533.7, 1.882,
	533.8, 1.831,
	533.9, 1.802,
	534.0, 1.774,
	534.1, 1.825,
	534.2, 1.876,
	534.3, 1.901,
	534.4, 1.927,
	534.5, 1.946,
	534.6, 1.965,
	534.7, 1.978,
	534.8, 1.990,
	534.9, 2.001,
	535.0, 2.012,
	535.1, 2.024,
	535.2, 2.036,
	535.3, 2.033,
	535.4, 2.029,
	535.5, 2.040,
	535.6, 2.050,
	535.7, 2.049,
	535.8, 2.048,
	535.9, 2.006,
	536.0, 1.964,
	536.1, 1.929,
	536.2, 1.893,
	536.3, 1.891,
	536.4, 1.859,
	536.5, 1.850,
	536.6, 1.841,
	536.7, 1.826,
	536.8, 1.810,
	536.9, 1.749,
	537.0, 1.689,
	537.1, 1.760,
	537.2, 1.832,
	537.3, 1.879,
	537.4, 1.927,
	537.5, 1.951,
	537.6, 1.975,
	537.7, 1.925,
	537.8, 1.875,
	537.9, 1.863,
	538.0, 1.851,
	538.1, 1.850,
	538.2, 1.849,
	538.3, 1.913,
	538.4, 1.976,
	538.5, 2.037,
	538.6, 2.098,
	538.7, 2.051,
	538.8, 2.003,
	538.9, 1.934,
	539.0, 1.864,
	539.1, 1.847,
	539.2, 1.830,
	539.3, 1.833,
	539.4, 1.835,
	539.5, 1.846,
	539.6, 1.857,
	539.7, 1.864,
	539.8, 1.870,
	539.9, 1.861,
	540.0, 1.852,
	540.1, 1.851,
	540.2, 1.850,
	540.3, 1.785,
	540.4, 1.719,
	540.5, 1.731,
	540.6, 1.743,
	540.7, 1.819,
	540.8, 1.895,
	540.9, 1.912,
	541.0, 1.928,
	541.1, 1.907,
	541.2, 1.886,
	541.3, 1.832,
	541.4, 1.778,
	541.5, 1.815,
	541.6, 1.851,
	541.7, 1.830,
	541.8, 1.809,
	541.9, 1.840,
	542.0, 1.871,
	542.1, 1.896,
	542.2, 1.920,
	542.3, 1.930,
	542.4, 1.939,
	542.5, 1.966,
	542.6, 1.994,
	542.7, 1.919,
	542.8, 1.845,
	542.9, 1.850,
	543.0, 1.854,
	543.1, 1.856,
	543.2, 1.858,
	543.3, 1.819,
	543.4, 1.781,
	543.5, 1.827,
	543.6, 1.873,
	543.7, 1.937,
	543.8, 2.002,
	543.9, 2.002,
	544.0, 2.002,
	544.1, 1.994,
	544.2, 1.985,
	544.3, 1.929,
	544.4, 1.873,
	544.5, 1.835,
	544.6, 1.797,
	544.7, 1.873,
	544.8, 1.950,
	544.9, 1.953,
	545.0, 1.956,
	545.1, 1.894,
	545.2, 1.833,
	545.3, 1.810,
	545.4, 1.787,
	545.5, 1.830,
	545.6, 1.872,
	545.7, 1.885,
	545.8, 1.899,
	545.9, 1.922,
	546.0, 1.946,
	546.1, 1.937,
	546.2, 1.927,
	546.3, 1.967,
	546.4, 2.007,
	546.5, 1.991,
	546.6, 1.975,
	546.7, 1.971,
	546.8, 1.966,
	546.9, 1.960,
	547.0, 1.953,
	547.1, 1.912,
	547.2, 1.872,
	547.3, 1.872,
	547.4, 1.872,
	547.5, 1.853,
	547.6, 1.834,
	547.7, 1.853,
	547.8, 1.871,
	547.9, 1.835,
	548.0, 1.799,
	548.1, 1.853,
	548.2, 1.908,
	548.3, 1.906,
	548.4, 1.905,
	548.5, 1.861,
	548.6, 1.816,
	548.7, 1.822,
	548.8, 1.827,
	548.9, 1.864,
	549.0, 1.901,
	549.1, 1.893,
	549.2, 1.885,
	549.3, 1.885,
	549.4, 1.884,
	549.5, 1.890,
	549.6, 1.895,
	549.7, 1.917,
	549.8, 1.940,
	549.9, 1.945,
	550.0, 1.849,
	550.1, 1.834,
	550.2, 1.819,
	550.3, 1.829,
	550.4, 1.840,
	550.5, 1.849,
	550.6, 1.858,
	550.7, 1.889,
	550.8, 1.921,
	550.9, 1.905,
	551.0, 1.888,
	551.1, 1.888,
	551.2, 1.888,
	551.3, 1.903,
	551.4, 1.919,
	551.5, 1.917,
	551.6, 1.916,
	551.7, 1.881,
	551.8, 1.846,
	551.9, 1.863,
	552.0, 1.880,
	552.1, 1.878,
	552.2, 1.877,
	552.3, 1.856,
	552.4, 1.836,
	552.5, 1.768,
	552.6, 1.700,
	552.7, 1.704,
	552.8, 1.708,
	552.9, 1.758,
	553.0, 1.808,
	553.1, 1.834,
	553.2, 1.860,
	553.3, 1.912,
	553.4, 1.963,
	553.5, 1.931,
	553.6, 1.899,
	553.7, 1.906,
	553.8, 1.914,
	553.9, 1.904,
	554.0, 1.895,
	554.1, 1.898,
	554.2, 1.902,
	554.3, 1.891,
	554.4, 1.880,
	554.5, 1.868,
	554.6, 1.856,
	554.7, 1.875,
	554.8, 1.895,
	554.9, 1.893,
	555.0, 1.892,
	555.1, 1.876,
	555.2, 1.860,
	555.3, 1.886,
	555.4, 1.912,
	555.5, 1.942,
	555.6, 1.973,
	555.7, 1.962,
	555.8, 1.951,
	555.9, 1.911,
	556.0, 1.871,
	556.1, 1.863,
	556.2, 1.855,
	556.3, 1.852,
	556.4, 1.849,
	556.5, 1.864,
	556.6, 1.878,
	556.7, 1.879,
	556.8, 1.880,
	556.9, 1.843,
	557.0, 1.805,
	557.1, 1.774,
	557.2, 1.743,
	557.3, 1.792,
	557.4, 1.841,
	557.5, 1.839,
	557.6, 1.836,
	557.7, 1.839,
	557.8, 1.843,
	557.9, 1.839,
	558.0, 1.835,
	558.1, 1.868,
	558.2, 1.901,
	558.3, 1.862,
	558.4, 1.823,
	558.5, 1.758,
	558.6, 1.693,
	558.7, 1.715,
	558.8, 1.738,
	558.9, 1.785,
	559.0, 1.832,
	559.1, 1.844,
	559.2, 1.856,
	559.3, 1.841,
	559.4, 1.831,
	559.5, 1.839,
	559.6, 1.847,
	559.7, 1.822,
	559.8, 1.797,
	559.9, 1.755,
	560.0, 1.712,
	560.1, 1.717,
	560.2, 1.723,
	560.3, 1.796,
	560.4, 1.870,
	560.5, 1.876,
	560.6, 1.883,
	560.7, 1.881,
	560.8, 1.880,
	560.9, 1.850,
	561.0, 1.820,
	561.1, 1.808,
	561.2, 1.795,
	561.3, 1.779,
	561.4, 1.762,
	561.5, 1.734,
	561.6, 1.705,
	561.7, 1.768,
	561.8, 1.830,
	561.9, 1.877,
	562.0, 1.925,
	562.1, 1.896,
	562.2, 1.868,
	562.3, 1.846,
	562.4, 1.824,
	562.5, 1.859,
	562.6, 1.894,
	562.7, 1.886,
	562.8, 1.878,
	562.9, 1.891,
	563.0, 1.905,
	563.1, 1.916,
	563.2, 1.926,
	563.3, 1.928,
	563.4, 1.929,
	563.5, 1.899,
	563.6, 1.869,
	563.7, 1.847,
	563.8, 1.825,
	563.9, 1.837,
	564.0, 1.849,
	564.1, 1.880,
	564.2, 1.912,
	564.3, 1.867,
	564.4, 1.822,
	564.5, 1.834,
	564.6, 1.846,
	564.7, 1.840,
	564.8, 1.835,
	564.9, 1.851,
	565.0, 1.867,
	565.1, 1.885,
	565.2, 1.903,
	565.3, 1.865,
	565.4, 1.827,
	565.5, 1.815,
	565.6, 1.803,
	565.7, 1.778,
	565.8, 1.754,
	565.9, 1.797,
	566.0, 1.841,
	566.1, 1.814,
	566.2, 1.787,
	566.3, 1.787,
	566.4, 1.825,
	566.5, 1.820,
	566.6, 1.814,
	566.7, 1.852,
	566.8, 1.890,
	566.9, 1.903,
	567.0, 1.915,
	567.1, 1.878,
	567.2, 1.842,
	567.3, 1.793,
	567.4, 1.812,
	567.5, 1.843,
	567.6, 1.875,
	567.7, 1.868,
	567.8, 1.861,
	567.9, 1.837,
	568.0, 1.813,
	568.1, 1.817,
	568.2, 1.821,
	568.3, 1.813,
	568.4, 1.786,
	568.5, 1.782,
	568.6, 1.778,
	568.7, 1.782,
	568.8, 1.786,
	568.9, 1.817,
	569.0, 1.849,
	569.1, 1.892,
	569.2, 1.936,
	569.3, 1.916,
	569.4, 1.895,
	569.5, 1.910,
	569.6, 1.925,
	569.7, 1.868,
	569.8, 1.811,
	569.9, 1.817,
	570.0, 1.822,
	570.1, 1.840,
	570.2, 1.858,
	570.3, 1.815,
	570.4, 1.772,
	570.5, 1.758,
	570.6, 1.745,
	570.7, 1.713,
	570.8, 1.680,
	570.9, 1.678,
	571.0, 1.675,
	571.1, 1.729,
	571.2, 1.782,
	571.3, 1.840,
	571.4, 1.897,
	571.5, 1.889,
	571.6, 1.881,
	571.7, 1.899,
	571.8, 1.917,
	571.9, 1.939,
	572.0, 1.961,
	572.1, 1.981,
	572.2, 2.000,
	572.3, 2.021,
	572.4, 2.042,
	572.5, 2.009,
	572.6, 1.977,
	572.7, 1.943,
	572.8, 1.909,
	572.9, 1.886,
	573.0, 1.863,
	573.1, 1.877,
	573.2, 1.891,
	573.3, 1.868,
	573.4, 1.845,
	573.5, 1.833,
	573.6, 1.821,
	573.7, 1.879,
	573.8, 1.937,
	573.9, 1.941,
	574.0, 1.945,
	574.1, 1.915,
	574.2, 1.886,
	574.3, 1.878,
	574.4, 1.870,
	574.5, 1.902,
	574.6, 1.933,
	574.7, 1.893,
	574.8, 1.852,
	574.9, 1.833,
	575.0, 1.814,
	575.1, 1.814,
	575.2, 1.815,
	575.3, 1.853,
	575.4, 1.890,
	575.5, 1.929,
	575.6, 1.968,
	575.7, 1.969,
	575.8, 1.969,
	575.9, 1.951,
	576.0, 1.932,
	576.1, 1.883,
	576.2, 1.834,
	576.3, 1.824,
	576.4, 1.855,
	576.5, 1.906,
	576.6, 1.958,
	576.7, 1.968,
	576.8, 1.978,
	576.9, 1.926,
	577.0, 1.875,
	577.1, 1.841,
	577.2, 1.807,
	577.3, 1.821,
	577.4, 1.824,
	577.5, 1.861,
	577.6, 1.897,
	577.7, 1.884,
	577.8, 1.871,
	577.9, 1.896,
	578.0, 1.922,
	578.1, 1.906,
	578.2, 1.890,
	578.3, 1.907,
	578.4, 1.891,
	578.5, 1.900,
	578.6, 1.909,
	578.7, 1.956,
	578.8, 2.004,
	578.9, 1.971,
	579.0, 1.939,
	579.1, 1.881,
	579.2, 1.823,
	579.3, 1.827,
	579.4, 1.830,
	579.5, 1.850,
	579.6, 1.870,
	579.7, 1.847,
	579.8, 1.824,
	579.9, 1.855,
	580.0, 1.886,
	580.1, 1.844,
	580.2, 1.803,
	580.3, 1.803,
	580.4, 1.803,
	580.5, 1.819,
	580.6, 1.836,
	580.7, 1.846,
	580.8, 1.855,
	580.9, 1.887,
	581.0, 1.919,
	581.1, 1.943,
	581.2, 1.967,
	581.3, 1.928,
	581.4, 1.889,
	581.5, 1.839,
	581.6, 1.788,
	581.7, 1.802,
	581.8, 1.816,
	581.9, 1.850,
	582.0, 1.883,
	582.1, 1.880,
	582.2, 1.877,
	582.3, 1.851,
	582.4, 1.824,
	582.5, 1.831,
	582.6, 1.838,
	582.7, 1.849,
	582.8, 1.860,
	582.9, 1.910,
	583.0, 1.960,
	583.1, 1.902,
	583.2, 1.844,
	583.3, 1.835,
	583.4, 1.827,
	583.5, 1.862,
	583.6, 1.896,
	583.7, 1.907,
	583.8, 1.919,
	583.9, 1.934,
	584.0, 1.949,
	584.1, 1.974,
	584.2, 1.999,
	584.3, 1.970,
	584.4, 1.941,
	584.5, 1.893,
	584.6, 1.846,
	584.7, 1.850,
	584.8, 1.854,
	584.9, 1.836,
	585.0, 1.818,
	585.1, 1.832,
	585.2, 1.846,
	585.3, 1.857,
	585.4, 1.868,
	585.5, 1.828,
	585.6, 1.787,
	585.7, 1.814,
	585.8, 1.840,
	585.9, 1.898,
	586.0, 1.957,
	586.1, 1.944,
	586.2, 1.932,
	586.3, 1.879,
	586.4, 1.826,
	586.5, 1.814,
	586.6, 1.801,
	586.7, 1.848,
	586.8, 1.895,
	586.9, 1.914,
	587.0, 1.932,
	587.1, 1.911,
	587.2, 1.890,
	587.3, 1.874,
	587.4, 1.859,
	587.5, 1.945,
	587.6, 1.942,
	587.7, 1.859,
	587.8, 1.829,
	587.9, 1.890,
	588.0, 1.887,
	588.1, 1.945,
	588.2, 1.890,
	588.3, 1.853,
	588.4, 1.839,
	588.5, 1.838,
	588.6, 1.837,
	588.7, 1.846,
	588.8, 1.856,
	588.9, 1.868,
	589.0, 1.281,
	589.1, 1.488,
	589.2, 1.695,
	589.3, 1.725,
	589.4, 1.756,
	589.5, 1.581,
	589.6, 1.406,
	589.7, 1.602,
	589.8, 1.797,
	589.9, 1.849,
	590.0, 1.900,
	590.1, 1.961,
	590.2, 2.023,
	590.3, 1.930,
	590.4, 1.837,
	590.5, 1.816,
	590.6, 1.796,
	590.7, 1.805,
	590.8, 1.815,
	590.9, 1.831,
	591.0, 1.846,
	591.1, 1.860,
	591.2, 1.874,
	591.3, 1.848,
	591.4, 1.822,
	591.5, 1.839,
	591.6, 1.855,
	591.7, 1.857,
	591.8, 1.859,
	591.9, 1.850,
	592.0, 1.842,
	592.1, 1.841,
	592.2, 1.840,
	592.3, 1.869,
	592.4, 1.899,
	592.5, 1.856,
	592.6, 1.813,
	592.7, 1.836,
	592.8, 1.860,
	592.9, 1.813,
	593.0, 1.766,
	593.1, 1.781,
	593.2, 1.797,
	593.3, 1.790,
	593.4, 1.783,
	593.5, 1.826,
	593.6, 1.870,
	593.7, 1.874,
	593.8, 1.879,
	593.9, 1.877,
	594.0, 1.876,
	594.1, 1.862,
	594.2, 1.848,
	594.3, 1.879,
	594.4, 1.910,
	594.5, 1.894,
	594.6, 1.877,
	594.7, 1.852,
	594.8, 1.827,
	594.9, 1.841,
	595.0, 1.855,
	595.1, 1.840,
	595.2, 1.824,
	595.3, 1.816,
	595.4, 1.807,
	595.5, 1.772,
	595.6, 1.737,
	595.7, 1.728,
	595.8, 1.720,
	595.9, 1.803,
	596.0, 1.886,
	596.1, 1.911,
	596.2, 1.936,
	596.3, 1.883,
	596.4, 1.852,
	596.5, 1.859,
	596.6, 1.856,
	596.7, 1.851,
	596.8, 1.837,
	596.9, 1.837,
	597.0, 1.837,
	597.1, 1.870,
	597.2, 1.903,
	597.3, 1.857,
	597.4, 1.811,
	597.5, 1.776,
	597.6, 1.741,
	597.7, 1.767,
	597.8, 1.793,
	597.9, 1.825,
	598.0, 1.857,
	598.1, 1.830,
	598.2, 1.803,
	598.3, 1.784,
	598.4, 1.764,
	598.5, 1.784,
	598.6, 1.805,
	598.7, 1.817,
	598.8, 1.830,
	598.9, 1.836,
	599.0, 1.843,
	599.1, 1.862,
	599.2, 1.881,
	599.3, 1.835,
	599.4, 1.789,
	599.5, 1.771,
	599.6, 1.753,
	599.7, 1.761,
	599.8, 1.769,
	599.9, 1.792,
	600.0, 1.816,
	600.1, 1.814,
	600.2, 1.813,
	600.3, 1.836,
	600.4, 1.860,
	600.5, 1.846,
	600.6, 1.832,
	600.7, 1.815,
	600.8, 1.799,
	600.9, 1.846,
	601.0, 1.893,
	601.1, 1.833,
	601.2, 1.774,
	601.3, 1.738,
	601.4, 1.702,
	601.5, 1.691,
	601.6, 1.679,
	601.7, 1.711,
	601.8, 1.743,
	601.9, 1.744,
	602.0, 1.746,
	602.1, 1.725,
	602.2, 1.704,
	602.3, 1.696,
	602.4, 1.688,
	602.5, 1.758,
	602.6, 1.829,
	602.7, 1.823,
	602.8, 1.818,
	602.9, 1.802,
	603.0, 1.787,
	603.1, 1.787,
	603.2, 1.787,
	603.3, 1.786,
	603.4, 1.784,
	603.5, 1.806,
	603.6, 1.829,
	603.7, 1.829,
	603.8, 1.829,
	603.9, 1.787,
	604.0, 1.745,
	604.1, 1.727,
	604.2, 1.709,
	604.3, 1.706,
	604.4, 1.704,
	604.5, 1.712,
	604.6, 1.720,
	604.7, 1.738,
	604.8, 1.756,
	604.9, 1.785,
	605.0, 1.814,
	605.1, 1.817,
	605.2, 1.820,
	605.3, 1.807,
	605.4, 1.795,
	605.5, 1.795,
	605.6, 1.795,
	605.7, 1.860,
	605.8, 1.925,
	605.9, 1.900,
	606.0, 1.875,
	606.1, 1.887,
	606.2, 1.900,
	606.3, 1.850,
	606.4, 1.808,
	606.5, 1.819,
	606.6, 1.831,
	606.7, 1.832,
	606.8, 1.833,
	606.9, 1.814,
	607.0, 1.794,
	607.1, 1.835,
	607.2, 1.875,
	607.3, 1.876,
	607.4, 1.877,
	607.5, 1.873,
	607.6, 1.869,
	607.7, 1.891,
	607.8, 1.913,
	607.9, 1.897,
	608.0, 1.880,
	608.1, 1.826,
	608.2, 1.772,
	608.3, 1.697,
	608.4, 1.645,
	608.5, 1.674,
	608.6, 1.703,
	608.7, 1.732,
	608.8, 1.761,
	608.9, 1.748,
	609.0, 1.736,
	609.1, 1.719,
	609.2, 1.703,
	609.3, 1.709,
	609.4, 1.716,
	609.5, 1.774,
	609.6, 1.833,
	609.7, 1.873,
	609.8, 1.913,
	609.9, 1.914,
	610.0, 1.915,
	610.1, 1.830,
	610.2, 1.745,
	610.3, 1.735,
	610.4, 1.758,
	610.5, 1.771,
	610.6, 1.784,
	610.7, 1.797,
	610.8, 1.811,
	610.9, 1.842,
	611.0, 1.873,
	611.1, 1.811,
	611.2, 1.750,
	611.3, 1.731,
	611.4, 1.726,
	611.5, 1.724,
	611.6, 1.722,
	611.7, 1.722,
	611.8, 1.723,
	611.9, 1.720,
	612.0, 1.716,
	612.1, 1.722,
	612.2, 1.729,
	612.3, 1.738,
	612.4, 1.778,
	612.5, 1.761,
	612.6, 1.745,
	612.7, 1.749,
	612.8, 1.752,
	612.9, 1.729,
	613.0, 1.706,
	613.1, 1.690,
	613.2, 1.674,
	613.3, 1.710,
	613.4, 1.745,
	613.5, 1.679,
	613.6, 1.612,
	613.7, 1.659,
	613.8, 1.706,
	613.9, 1.722,
	614.0, 1.738,
	614.1, 1.731,
	614.2, 1.723,
	614.3, 1.757,
	614.4, 1.792,
	614.5, 1.763,
	614.6, 1.734,
	614.7, 1.738,
	614.8, 1.741,
	614.9, 1.764,
	615.0, 1.788,
	615.1, 1.782,
	615.2, 1.776,
	615.3, 1.727,
	615.4, 1.678,
	615.5, 1.686,
	615.6, 1.695,
	615.7, 1.733,
	615.8, 1.771,
	615.9, 1.702,
	616.0, 1.634,
	616.1, 1.618,
	616.2, 1.603,
	616.3, 1.627,
	616.4, 1.651,
	616.5, 1.651,
	616.6, 1.651,
	616.7, 1.665,
	616.8, 1.679,
	616.9, 1.724,
	617.0, 1.768,
	617.1, 1.785,
	617.2, 1.801,
	617.3, 1.764,
	617.4, 1.726,
	617.5, 1.703,
	617.6, 1.679,
	617.7, 1.717,
	617.8, 1.754,
	617.9, 1.746,
	618.0, 1.738,
	618.1, 1.764,
	618.2, 1.790,
	618.3, 1.797,
	618.4, 1.803,
	618.5, 1.770,
	618.6, 1.737,
	618.7, 1.726,
	618.8, 1.715,
	618.9, 1.732,
	619.0, 1.748,
	619.1, 1.771,
	619.2, 1.795,
	619.3, 1.799,
	619.4, 1.814,
	619.5, 1.833,
	619.6, 1.852,
	619.7, 1.860,
	619.8, 1.868,
	619.9, 1.831,
	620.0, 1.794,
	620.2, 1.734,
	620.4, 1.707,
	620.6, 1.736,
	620.8, 1.783,
	621.0, 1.792,
	621.2, 1.802,
	621.4, 1.852,
	621.6, 1.751,
	621.8, 1.699,
	622.0, 1.687,
	622.2, 1.714,
	622.4, 1.772,
	622.6, 1.741,
	622.8, 1.695,
	623.0, 1.671,
	623.2, 1.697,
	623.4, 1.713,
	623.6, 1.679,
	623.8, 1.692,
	624.0, 1.690,
	624.2, 1.627,
	624.4, 1.590,
	624.6, 1.594,
	624.8, 1.689,
	625.0, 1.691,
	625.2, 1.675,
	625.4, 1.674,
	625.6, 1.675,
	625.8, 1.723,
	626.0, 1.776,
	626.2, 1.792,
	626.4, 1.793,
	626.6, 1.780,
	626.8, 1.731,
	627.0, 1.754,
	627.2, 1.766,
	627.4, 1.715,
	627.6, 1.695,
	627.8, 1.669,
	628.0, 1.670,
	628.2, 1.654,
	628.4, 1.663,
	628.6, 1.705,
	628.8, 1.755,
	629.0, 1.743,
	629.2, 1.711,
	629.4, 1.731,
	629.6, 1.694,
	629.8, 1.693,
	630.0, 1.651,
	630.2, 1.649,
	630.4, 1.660,
	630.6, 1.688,
	630.8, 1.699,
	631.0, 1.649,
	631.2, 1.621,
	631.4, 1.620,
	631.6, 1.678,
	631.8, 1.711,
	632.0, 1.798,
	632.2, 1.771,
	632.4, 1.756,
	632.6, 1.750,
	632.8, 1.746,
	633.0, 1.716,
	633.2, 1.649,
	633.4, 1.617,
	633.6, 1.647,
	633.8, 1.694,
	634.0, 1.682,
	634.2, 1.674,
	634.4, 1.683,
	634.6, 1.698,
	634.8, 1.714,
	635.0, 1.692,
	635.2, 1.627,
	635.4, 1.620,
	635.6, 1.641,
	635.8, 1.639,
	636.0, 1.638,
	636.2, 1.675,
	636.4, 1.681,
	636.6, 1.709,
	636.8, 1.739,
	637.0, 1.731,
	637.2, 1.719,
	637.4, 1.745,
	637.6, 1.717,
	637.8, 1.658,
	638.0, 1.702,
	638.2, 1.803,
	638.4, 1.797,
	638.6, 1.753,
	638.8, 1.703,
	639.0, 1.707,
	639.2, 1.676,
	639.4, 1.677,
	639.6, 1.676,
	639.8, 1.698,
	640.0, 1.685,
	640.2, 1.686,
	640.4, 1.634,
	640.6, 1.570,
	640.8, 1.557,
	641.0, 1.581,
	641.2, 1.620,
	641.4, 1.642,
	641.6, 1.650,
	641.8, 1.643,
	642.0, 1.642,
	642.2, 1.670,
	642.4, 1.727,
	642.6, 1.714,
	642.8, 1.634,
	643.0, 1.609,
	643.2, 1.581,
	643.4, 1.597,
	643.6, 1.652,
	643.8, 1.699,
	644.0, 1.714,
	644.2, 1.698,
	644.4, 1.669,
	644.6, 1.597,
	644.8, 1.564,
	645.0, 1.599,
	645.2, 1.671,
	645.4, 1.660,
	645.6, 1.708,
	645.8, 1.746,
	646.0, 1.697,
	646.2, 1.616,
	646.4, 1.615,
	646.6, 1.608,
	646.8, 1.636,
	647.0, 1.656,
	647.2, 1.626,
	647.4, 1.595,
	647.6, 1.599,
	647.8, 1.621,
	648.0, 1.615,
	648.2, 1.629,
	648.4, 1.625,
	648.6, 1.591,
	648.8, 1.542,
	649.0, 1.518,
	649.2, 1.443,
	649.4, 1.420,
	649.6, 1.509,
	649.8, 1.556,
	650.0, 1.577,
	650.2, 1.615,
	650.4, 1.654,
	650.6, 1.640,
	650.8, 1.606,
	651.0, 1.600,
	651.2, 1.636,
	651.4, 1.633,
	651.6, 1.626,
	651.8, 1.688,
	652.0, 1.744,
	652.2, 1.727,
	652.4, 1.614,
	652.6, 1.553,
	652.8, 1.541,
	653.0, 1.598,
	653.2, 1.678,
	653.4, 1.756,
	653.6, 1.719,
	653.8, 1.643,
	654.0, 1.599,
	654.2, 1.585,
	654.4, 1.598,
	654.6, 1.604,
	654.8, 1.613,
	655.0, 1.570,
	655.2, 1.526,
	655.4, 1.514,
	655.6, 1.539,
	655.8, 1.414,
	656.0, 1.209,
	656.2, 1.116,
	656.4, 1.293,
	656.6, 1.461,
	656.8, 1.598,
	657.0, 1.627,
	657.2, 1.589,
	657.4, 1.533,
	657.6, 1.520,
	657.8, 1.542,
	658.0, 1.599,
	658.2, 1.608,
	658.4, 1.608,
	658.6, 1.591,
	658.8, 1.575,
	659.0, 1.596,
	659.2, 1.573,
	659.4, 1.540,
	659.6, 1.571,
	659.8, 1.611,
	660.0, 1.680,
	660.4, 1.557,
	660.8, 1.635,
	661.2, 1.613,
	661.6, 1.599,
	662.0, 1.623,
	662.4, 1.604,
	662.8, 1.593,
	663.2, 1.561,
	663.6, 1.653,
	664.0, 1.654,
	664.4, 1.570,
	664.8, 1.580,
	665.2, 1.627,
	665.6, 1.640,
	666.0, 1.636,
	666.4, 1.589,
	666.8, 1.542,
	667.2, 1.619,
	667.6, 1.628,
	668.0, 1.598,
	668.4, 1.650,
	668.8, 1.534,
	669.2, 1.525,
	669.6, 1.640,
	670.0, 1.692,
	670.4, 1.561,
	670.8, 1.589,
	671.2, 1.585,
	671.6, 1.550,
	672.0, 1.528,
	672.4, 1.520,
	672.8, 1.538,
	673.2, 1.554,
	673.6, 1.598,
	674.0, 1.602,
	674.4, 1.604,
	674.8, 1.633,
	675.2, 1.577,
	675.6, 1.605,
	676.0, 1.578,
	676.4, 1.558,
	676.8, 1.566,
	677.2, 1.604,
	677.6, 1.634,
	678.0, 1.537,
	678.4, 1.559,
	678.8, 1.564,
	679.2, 1.573,
	679.6, 1.574,
	680.0, 1.578,
	680.4, 1.605,
	680.8, 1.554,
	681.2, 1.527,
	681.6, 1.581,
	682.0, 1.578,
	682.4, 1.556,
	682.8, 1.518,
	683.2, 1.598,
	683.6, 1.570,
	684.0, 1.504,
	684.4, 1.525,
	684.8, 1.565,
	685.2, 1.517,
	685.6, 1.532,
	686.0, 1.566,
	686.4, 1.520,
	686.8, 1.447,
	687.2, 1.441,
	687.6, 1.454,
	688.0, 1.495,
	688.4, 1.443,
	688.8, 1.454,
	689.2, 1.498,
	689.6, 1.512,
	690.0, 1.504,
	690.4, 1.548,
	690.8, 1.508,
	691.2, 1.508,
	691.6, 1.513,
	692.0, 1.438,
	692.4, 1.513,
	692.8, 1.531,
	693.2, 1.456,
	693.6, 1.539,
	694.0, 1.534,
	694.4, 1.520,
	694.8, 1.574,
	695.2, 1.558,
	695.6, 1.492,
	696.0, 1.526,
	696.4, 1.466,
	696.8, 1.536,
	697.2, 1.585,
	697.6, 1.550,
	698.0, 1.514,
	698.4, 1.575,
	698.8, 1.518,
	699.2, 1.456,
	699.6, 1.461,
	700.0, 1.495,
	702.0, 1.471,
	704.0, 1.476,
	706.0, 1.450,
	708.0, 1.427,
	710.0, 1.455,
	712.0, 1.439,
	714.0, 1.421,
	716.0, 1.406,
	718.0, 1.393,
	720.0, 1.367,
	722.0, 1.396,
	724.0, 1.406,
	726.0, 1.392,
	728.0, 1.366,
	730.0, 1.367,
	732.0, 1.362,
	734.0, 1.359,
	736.0, 1.363,
	738.0, 1.332,
	740.0, 1.316,
	742.0, 1.302,
	744.0, 1.306,
	746.0, 1.308,
	748.0, 1.314,
	750.0, 1.308,
	752.0, 1.297,
	754.0, 1.297,
	756.0, 1.292,
	758.0, 1.283,
	760.0, 1.269,
	762.0, 1.272,
	764.0, 1.255,
	766.0, 1.251,
	768.0, 1.235,
	770.0, 1.226,
	772.0, 1.217,
	774.0, 1.216,
	776.0, 1.197,
	778.0, 1.218,
	780.0, 1.223,
};

// CIE 1964 supplementary standard colorimetric observer\
[380-780] nm range, 5 nm step\
!: consider constexpr ctors (and other stuff) for vector math
const double3 CIE_colorMatchingTable[] =
{
	{0.000160, 0.000017, 0.000705},
	{0.000662, 0.000072, 0.002928},
	{0.002362, 0.000253, 0.010482},
	{0.007242, 0.000769, 0.032344},
	{0.019110, 0.002004, 0.086011},
	{0.043400, 0.004509, 0.197120},
	{0.084736, 0.008756, 0.389366},
	{0.140638, 0.014456, 0.656760},
	{0.204492, 0.021391, 0.972542},
	{0.264737, 0.029497, 1.282500},
	{0.314679, 0.038676, 1.553480},
	{0.357719, 0.049602, 1.798500},
	{0.383734, 0.062077, 1.967280},
	{0.386726, 0.074704, 2.027300},
	{0.370702, 0.089456, 1.994800},
	{0.342957, 0.106256, 1.900700},
	{0.302273, 0.128201, 1.745370},
	{0.254085, 0.152761, 1.554900},
	{0.195618, 0.185190, 1.317560},
	{0.132349, 0.219940, 1.030200},
	{0.080507, 0.253589, 0.772125},
	{0.041072, 0.297665, 0.570060},
	{0.016172, 0.339133, 0.415254},
	{0.005132, 0.395379, 0.302356},
	{0.003816, 0.460777, 0.218502},
	{0.015444, 0.531360, 0.159249},
	{0.037465, 0.606741, 0.112044},
	{0.071358, 0.685660, 0.082248},
	{0.117749, 0.761757, 0.060709},
	{0.172953, 0.823330, 0.043050},
	{0.236491, 0.875211, 0.030451},
	{0.304213, 0.923810, 0.020584},
	{0.376772, 0.961988, 0.013676},
	{0.451584, 0.982200, 0.007918},
	{0.529826, 0.991761, 0.003988},
	{0.616053, 0.999110, 0.001091},
	{0.705224, 0.997340, 0.000000},
	{0.793832, 0.982380, 0.000000},
	{0.878655, 0.955552, 0.000000},
	{0.951162, 0.915175, 0.000000},
	{1.014160, 0.868934, 0.000000},
	{1.074300, 0.825623, 0.000000},
	{1.118520, 0.777405, 0.000000},
	{1.134300, 0.720353, 0.000000},
	{1.123990, 0.658341, 0.000000},
	{1.089100, 0.593878, 0.000000},
	{1.030480, 0.527963, 0.000000},
	{0.950740, 0.461834, 0.000000},
	{0.856297, 0.398057, 0.000000},
	{0.754930, 0.339554, 0.000000},
	{0.647467, 0.283493, 0.000000},
	{0.535110, 0.228254, 0.000000},
	{0.431567, 0.179828, 0.000000},
	{0.343690, 0.140211, 0.000000},
	{0.268329, 0.107633, 0.000000},
	{0.204300, 0.081187, 0.000000},
	{0.152568, 0.060281, 0.000000},
	{0.112210, 0.044096, 0.000000},
	{0.081261, 0.031800, 0.000000},
	{0.057930, 0.022602, 0.000000},
	{0.040851, 0.015905, 0.000000},
	{0.028623, 0.011130, 0.000000},
	{0.019941, 0.007749, 0.000000},
	{0.013842, 0.005375, 0.000000},
	{0.009577, 0.003718, 0.000000},
	{0.006605, 0.002565, 0.000000},
	{0.004553, 0.001768, 0.000000},
	{0.003145, 0.001222, 0.000000},
	{0.002175, 0.000846, 0.000000},
	{0.001506, 0.000586, 0.000000},
	{0.001045, 0.000407, 0.000000},
	{0.000727, 0.000284, 0.000000},
	{0.000508, 0.000199, 0.000000},
	{0.000356, 0.000140, 0.000000},
	{0.000251, 0.000098, 0.000000},
	{0.000178, 0.000070, 0.000000},
	{0.000126, 0.000050, 0.000000},
	{0.000090, 0.000036, 0.000000},
	{0.000065, 0.000025, 0.000000},
	{0.000046, 0.000018, 0.000000},
	{0.000033, 0.000013, 0.000000}
};

// XYZ -> sRGB D65 transformation matrix from http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html
const double3x3 XYZ_2_RGB
(
	+3.2404542, -1.5371385, -0.4985314,
	-0.9692660, +1.8760108, +0.0415560,
	+0.0556434, -0.2040259, +1.0572252
);

template<bool weights>
using BaseIteratorSelector = iterator<random_access_iterator_tag, conditional_t<weights, VectorMath::vector<double3, 2>, pair<double2, double2>>, make_signed_t<size_t>, void, void>;

template<bool weights>
class SegmentIterator : public BaseIteratorSelector<weights>
{
	size_t segIdx;
	typedef BaseIteratorSelector<weights> iterator;

public:
	using typename iterator::difference_type;
	using typename iterator::value_type;

public:
	constexpr explicit SegmentIterator(size_t segIdx) noexcept : segIdx(segIdx) {}

public:
	constexpr SegmentIterator &operator ++() noexcept { return ++segIdx, *this; }
	constexpr SegmentIterator &operator --() noexcept { return --segIdx, *this; }
	constexpr SegmentIterator operator ++(int) noexcept { return SegmentIterator(segIdx++); }
	constexpr SegmentIterator operator --(int) noexcept { return SegmentIterator(segIdx--); }
	constexpr SegmentIterator operator +(difference_type offset) const noexcept { return SegmentIterator(segIdx + offset); }
	constexpr SegmentIterator operator -(difference_type offset) const noexcept { return SegmentIterator(segIdx - offset); }
	constexpr difference_type operator -(const SegmentIterator sub) const noexcept { return segIdx - sub.segIdx; }

public:
	// TODO: replace with C++20 <=>
	constexpr bool operator < (const SegmentIterator cmp) const noexcept { return segIdx <  cmp.segIdx; }
	constexpr bool operator > (const SegmentIterator cmp) const noexcept { return segIdx >  cmp.segIdx; }
	constexpr bool operator <=(const SegmentIterator cmp) const noexcept { return segIdx <= cmp.segIdx; }
	constexpr bool operator >=(const SegmentIterator cmp) const noexcept { return segIdx >= cmp.segIdx; }
	constexpr bool operator ==(const SegmentIterator cmp) const noexcept { return segIdx == cmp.segIdx; }
	constexpr bool operator !=(const SegmentIterator cmp) const noexcept { return segIdx != cmp.segIdx; }

public:
	value_type operator *() const;
};

template<>
auto SegmentIterator<false>::operator *() const -> value_type
{
	return { { spectralIrradianceTable[segIdx][0], spectralIrradianceTable[segIdx + 1][0] }, { spectralIrradianceTable[segIdx][1], spectralIrradianceTable[segIdx + 1][1] } };
}

template<>
auto SegmentIterator<true>::operator *() const -> value_type
{
	using VectorMath::AsScalar;

	double2 samplePos(spectralIrradianceTable[segIdx][0], spectralIrradianceTable[segIdx + 1][0]);

	// remap λ range
	samplePos -= spectralIrradianceTable[0][0];
	samplePos *= (size(CIE_colorMatchingTable) - 1) / ((*prev(end(spectralIrradianceTable)))[0] - (*begin(spectralIrradianceTable))[0]);

	const auto Fetch = [](double samplePos) -> tuple<double3, double3, double>/*left, right, fract*/
	{
		using namespace placeholders;
		const auto Clamp = bind(clamp<make_signed_t<size_t>>, _1, 0, size(CIE_colorMatchingTable) - 1);
		double dataSegIdx, fract = modf(samplePos, &dataSegIdx);
		const auto leftIdx = Clamp(dataSegIdx), rightIdx = Clamp(leftIdx + 1);
		return { CIE_colorMatchingTable[leftIdx], CIE_colorMatchingTable[rightIdx], fract };
	};
	const auto left = Fetch(samplePos[0]), right = Fetch(samplePos[1]);
	return lerp(value_type(AsScalar(get<0>(left)), AsScalar(get<0>(right))), value_type(AsScalar(get<1>(left)), AsScalar(get<1>(right))), double2(get<2>(left), get<2>(right)));
}

typedef SegmentIterator<false> DataSegmentIterator;
typedef SegmentIterator<true> WeightsSegmentIterator;

const double3 sunExtraterrestrialIrradianceRGB = []
{
	// TODO: replace with static_assert when C++20 constexpr is_sorted turns up
	assert(is_sorted(begin(spectralIrradianceTable), end(spectralIrradianceTable), [](const remove_extent_t<decltype(spectralIrradianceTable)> &left, const remove_extent_t<decltype(spectralIrradianceTable)> &right) constexpr noexcept
	{
		return left[0] < right[0];
	}));

	const auto EvalSeg = [](const DataSegmentIterator::value_type &data, const WeightsSegmentIterator::value_type &weights)
	{
		return dot(data.second, weights) * (.5/*avaraging factor after dot*/ * (data.first[1] - data.first[0])/*dλ*/);
	};
	const double3 XYZ = inner_product(DataSegmentIterator(0), DataSegmentIterator(size(spectralIrradianceTable)), WeightsSegmentIterator(0), double3(), plus(), EvalSeg);
	return mul(XYZ_2_RGB, XYZ);
}();

float3 Sun::Dir(float zenith, float azimuth)
{
	float3 dir(cos(azimuth), sin(azimuth), cos(zenith));
	dir.xy *= sin(zenith);
	return dir;
}

float3 Sun::Irradiance(float zenith, float cosZenith)
{
	// calculate rcp of relative optical mass
	const double m_rcp = cosZenith + .15 * pow(93.885 - 180 * M_1_PI * fabs(zenith), -1.253);

	// from http://www.babelcolor.com/index_htm_files/A%20review%20of%20RGB%20color%20spaces.pdf
	static const double3 RGB_primaries(.610, .530, .450);	// in μm

	// Rayleigh scattering
	using namespace std::placeholders;
	static const double3 RayleighFactor = -.008735 * RGB_primaries.apply(bind(powl/*to eliminate ambiguity of pow*/, _1, -4.08));
	return sunExtraterrestrialIrradianceRGB * (RayleighFactor / m_rcp).apply(exp);
}